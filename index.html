<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>道德经 · 老子</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* 自定义样式 */
        :root {
            --paper-bg: #fdfbf7;
            --ink-color: #2c2c2c;
            --seal-red: #b22c2c;
            --accent-gray: #8c8c8c;
        }

        body {
            background-color: var(--paper-bg);
            color: var(--ink-color);
            font-family: 'Noto Serif SC', serif;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.05'/%3E%3C/svg%3E");
            overflow-x: hidden;
        }

        .font-calligraphy {
            font-family: 'Ma Shan Zheng', cursive;
        }

        /* 隐藏滚动条但保留功能 */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* 竖排文字 */
        .vertical-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            letter-spacing: 0.3em;
        }

        /* 印章效果 */
        .seal {
            border: 2px solid var(--seal-red);
            color: var(--seal-red);
            padding: 4px;
            font-family: 'Ma Shan Zheng', cursive;
            border-radius: 4px;
            display: inline-block;
            font-size: 0.8rem;
            line-height: 1;
        }

        /* 章节过渡动画 */
        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .chapter-nav-item.active {
            color: black;
            font-weight: bold;
            border-left: 3px solid var(--seal-red);
            padding-left: 0.5rem;
            background-color: rgba(0,0,0,0.03);
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col md:flex-row">

    <!-- 侧边栏 (目录) -->
    <aside id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-[#f4f0e6] transform -translate-x-full transition-transform duration-300 md:translate-x-0 md:static md:w-1/4 lg:w-1/5 border-r border-stone-200 shadow-lg md:shadow-none flex flex-col">
        <div class="p-6 text-center border-b border-stone-300">
            <h1 class="text-3xl font-calligraphy text-stone-800 mb-2">道德经</h1>
            <div class="text-xs text-stone-500 tracking-widest uppercase">Dao De Jing</div>
            <div class="mt-4 flex justify-center">
                <div class="seal">老子著</div>
            </div>
        </div>
        
        <div class="flex-1 overflow-y-auto no-scrollbar py-4" id="chapter-list">
            <!-- 章节列表将由 JS 生成 -->
        </div>

        <div class="p-4 text-center text-xs text-stone-400 border-t border-stone-300">
            道法自然 · 宁静致远
        </div>
    </aside>

    <!-- 移动端菜单按钮 -->
    <button id="menu-btn" class="fixed top-4 left-4 z-50 p-2 bg-[#f4f0e6]/80 backdrop-blur rounded-full shadow-md md:hidden border border-stone-300 text-stone-700">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>
    
    <!-- 遮罩层 (移动端) -->
    <div id="overlay" class="fixed inset-0 bg-black/20 z-40 hidden md:hidden backdrop-blur-sm transition-opacity opacity-0"></div>

    <!-- 主内容区 -->
    <main class="flex-1 relative h-screen overflow-y-auto">
        <div class="max-w-3xl mx-auto px-6 py-12 md:py-20 min-h-full flex flex-col justify-center transition-all duration-500" id="content-area">
            
            <!-- 初始欢迎界面 -->
            <div id="intro-view" class="text-center py-20 fade-in">
                <div class="mb-12 opacity-80 select-none pointer-events-none">
                    <img src="https://api.iconify.design/game-icons:bamboo.svg?color=%238a9a5b" class="w-24 h-24 mx-auto mb-4 opacity-50" alt="Bamboo">
                </div>
                <h2 class="text-5xl md:text-7xl font-calligraphy mb-8 text-stone-800 tracking-widest">道</h2>
                <p class="text-xl md:text-2xl text-stone-600 mb-12 font-light">五千言 · 悟真理</p>
                <button onclick="loadChapter(0)" class="px-8 py-3 border border-stone-400 rounded hover:bg-stone-800 hover:text-[#fdfbf7] transition duration-300 tracking-widest text-sm uppercase">
                    开始阅读
                </button>
            </div>

            <!-- 章节内容容器 (初始隐藏) -->
            <div id="chapter-view" class="hidden fade-in">
                <div class="flex justify-between items-start mb-8 pb-4 border-b border-stone-300/50">
                    <div>
                        <span class="text-stone-400 text-sm tracking-widest block mb-1">CHAPTER</span>
                        <h2 id="chapter-title" class="text-3xl md:text-4xl font-bold text-stone-800 font-calligraphy">第一章</h2>
                    </div>
                    <div class="hidden md:block vertical-text text-stone-400 h-16 font-calligraphy text-sm opacity-60">
                        无为而无不为
                    </div>
                </div>

                <div id="chapter-text" class="text-lg md:text-xl leading-loose text-justify text-stone-700 font-light tracking-wide mb-16 min-h-[50vh]">
                    <!-- 正文内容 -->
                </div>

                <div class="flex justify-between items-center pt-8 border-t border-stone-300/50">
                    <button id="prev-btn" class="flex items-center text-stone-500 hover:text-stone-800 transition disabled:opacity-30 disabled:cursor-not-allowed">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        <span class="font-serif">上一章</span>
                    </button>

                    <div class="text-stone-400 text-sm italic font-serif">
                        <span id="current-chapter-num">1</span> / 81
                    </div>

                    <button id="next-btn" class="flex items-center text-stone-500 hover:text-stone-800 transition disabled:opacity-30 disabled:cursor-not-allowed">
                        <span class="font-serif">下一章</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </button>
                </div>
            </div>

        </div>
    </main>

    <script>
        // 道德经完整数据 (包含全部81章完整文本)
        const daoDeJing = [
            { id: 1, text: "道可道，非常道；名可名，非常名。\n无名，天地之始；有名，万物之母。\n故常无欲，以观其妙；常有欲，以观其徼。\n此两者，同出而异名，同谓之玄。\n玄之又玄，众妙之门。" },
            { id: 2, text: "天下皆知美之为美，斯恶已；皆知善之为善，斯不善已。\n故有无相生，难易相成，长短相形，高下相倾，音声相和，前后相随。\n是以圣人处无为之事，行不言之教。\n万物作焉而不辞，生而不有，为而不恃，功成而弗居。\n夫唯弗居，是以不去。" },
            { id: 3, text: "不尚贤，使民不争；不贵难得之货，使民不为盗；不见可欲，使民心不乱。\n是以圣人之治，虚其心，实其腹，弱其志，强其骨。\n常使民无知无欲，使夫智者不敢为也。\n为无为，则无不治。" },
            { id: 4, text: "道冲，而用之或不盈。渊兮，似万物之宗。\n挫其锐，解其纷，和其光，同其尘。\n湛兮，似或存。\n吾不知谁之子，象帝之先。" },
            { id: 5, text: "天地不仁，以万物为刍狗；圣人不仁，以百姓为刍狗。\n天地之间，其犹橐龠乎？虚而不屈，动而愈出。\n多言数穷，不如守中。" },
            { id: 6, text: "谷神不死，是谓玄牝。玄牝之门，是谓天地根。绵绵若存，用之不勤。" },
            { id: 7, text: "天长地久。天地所以能长且久者，以其不自生，故能长生。\n是以圣人后其身而身先，外其身而身存。\n非以其无私邪？故能成其私。" },
            { id: 8, text: "上善若水。水善利万物而不争，处众人之所恶，故几于道。\n居善地，心善渊，与善仁，言善信，政善治，事善能，动善时。\n夫唯不争，故无尤。" },
            { id: 9, text: "持而盈之，不如其已；揣而锐之，不可长保。\n金玉满堂，莫之能守；富贵而骄，自遗其咎。\n功成身退，天之道。" },
            { id: 10, text: "载营魄抱一，能无离乎？\n专气致柔，能婴儿乎？\n涤除玄览，能无疵乎？\n爱民治国，能无为乎？\n天门开阖，能为雌乎？\n明白四达，能无知乎？" },
            { id: 11, text: "三十辐共一毂，当其无，有车之用。\n埏埴以为器，当其无，有器之用。\n凿户牖以为室，当其无，有室之用。\n故有之以为利，无之以为用。" },
            { id: 12, text: "五色令人目盲；五音令人耳聋；五味令人口爽；驰骋畋猎令人心发狂；难得之货令人行妨。\n是以圣人为腹不为目，故去彼取此。" },
            { id: 13, text: "宠辱若惊，贵大患若身。\n何谓宠辱若惊？宠为下，得之若惊，失之若惊，是谓宠辱若惊。\n何谓贵大患若身？吾所以有大患者，为吾有身，及吾无身，吾有何患？\n故贵以身为天下，若可寄天下；爱以身为天下，若可托天下。" },
            { id: 14, text: "视之不见，名曰夷；听之不闻，名曰希；搏之不得，名曰微。\n此三者不可致诘，故混而为一。\n其上不皦，其下不昧。绳绳不可名，复归于物。\n是谓无状之状，无物之象，是谓惚恍。\n迎之不见其首，随之不见其后。\n执古之道，以御今之有。能知古始，是谓道纪。" },
            { id: 15, text: "古之善为士者，微妙玄通，深不可识。\n夫唯不可识，故强为之容：\n豫兮若冬涉川；犹兮若畏四邻；俨兮其若客；涣兮若冰之将释；\n敦兮其若朴；旷兮其若谷；浑兮其若浊；孰能浊以静之徐清？\n孰能安以久动之徐生？保此道者不欲盈，夫唯不盈，故能蔽不新成。" },
            { id: 16, text: "致虚极，守静笃。\n万物并作，吾以观复。\n夫物芸芸，各复归其根。\n归根曰静，静曰复命。\n复命曰常，知常曰明。\n不知常，妄作凶。\n知常容，容乃公，公乃王，王乃天，天乃道，道乃久，殁身不殆。" },
            { id: 17, text: "太上，下知有之；其次，亲而誉之；其次，畏之；其次，侮之。\n信不足焉，有不信焉。\n悠兮其贵言。功成事遂，百姓皆谓我自然。" },
            { id: 18, text: "大道废，有仁义；慧智出，有大伪；六亲不和，有孝慈；国家昏乱，有忠臣。" },
            { id: 19, text: "绝圣弃智，民利百倍；绝仁弃义，民复孝慈；绝巧弃利，盗贼无有。\n此三者以为文不足，故令有所属：见素抱朴，少私寡欲，绝学无忧。" },
            { id: 20, text: "唯之与阿，相去几何？美之与恶，相去若何？\n人之所畏，不可不畏。\n荒兮其未央哉！\n众人熙熙，如享太牢，如春登台。\n我独泊兮其未兆，如婴儿之未孩。\n儽儽兮若无所归。\n众人皆有余，而我独若遗。我愚人之心也哉！\n沌沌兮，俗人昭昭，我独昏昏；俗人察察，我独闷闷。\n澹兮其若海，飂兮若无止。\n众人皆有以，而我独顽且鄙。\n我独异于人，而贵食母。" },
            { id: 21, text: "孔德之容，惟道是从。\n道之为物，惟恍惟惚。\n惚兮恍兮，其中有象；恍兮惚兮，其中有物。\n窈兮冥兮，其中有精；其精甚真，其中有信。\n自古及今，其名不去，以阅众甫。\n吾何以知众甫之状哉？以此。" },
            { id: 22, text: "曲则全，枉则直，洼则盈，敝则新，少则得，多则惑。\n是以圣人抱一为天下式。\n不自见，故明；不自是，故彰；不自伐，故有功；不自矜，故长。\n夫唯不争，故天下莫能与之争。\n古之所谓曲则全者，岂虚言哉！诚全而归之。" },
            { id: 23, text: "希言自然。\n故飘风不终朝，骤雨不终日。\n孰为此者？天地。天地尚不能久，而况于人乎？\n故从事于道者，同于道；德者，同于德；失者，同于失。\n同于道者，道亦乐得之；同于德者，德亦乐得之；同于失者，失亦乐得之。\n信不足焉，有不信焉。" },
            { id: 24, text: "企者不立，跨者不行。\n自见者不明，自是者不彰，自伐者无功，自矜者不长。\n其在道也，曰余食赘行。\n物或恶之，故有道者不处。" },
            { id: 25, text: "有物混成，先天地生。\n寂兮寥兮，独立而不改，周行而不殆，可以为天地母。\n吾不知其名，字之曰道，强为之名曰大。\n大曰逝，逝曰远，远曰反。\n故道大，天大，地大，王亦大。\n域中有四大，而王居其一焉。\n人法地，地法天，天法道，道法自然。" },
            { id: 26, text: "重为轻根，静为躁君。\n是以君子终日行不离辎重。\n虽有荣观，燕处超然。\n奈何万乘之主，而以身轻天下？\n轻则失本，躁则失君。" },
            { id: 27, text: "善行无辙迹，善言无瑕谪；善数不用筹策；善闭无关楗而不可开，善结无绳约而不可解。\n是以圣人常善救人，故无弃人；常善救物，故无弃物。\n是谓袭明。\n故善人者，不善人之师；不善人者，善人之资。\n不贵其师，不爱其资，虽智大迷，是谓要妙。" },
            { id: 28, text: "知其雄，守其雌，为天下谿。为天下谿，常德不离，复归于婴儿。\n知其白，守其黑，为天下式。为天下式，常德不忒，复归于无极。\n知其荣，守其辱，为天下谷。为天下谷，常德乃足，复归于朴。\n朴散则为器，圣人用之，则为官长。\n故大制不割。" },
            { id: 29, text: "将欲取天下而为之，吾见其不得已。\n天下神器，不可为也，不可执也。\n为者败之，执者失之。\n是以圣人无为，故无败；无执，故无失。\n夫物或行或随，或歔或吹，或强或羸，或挫或隳。\n是以圣人去甚，去奢，去泰。" },
            { id: 30, text: "以道佐人主者，不以兵强天下，其事好还。\n师之所处，荆棘生焉。\n大军之后，必有凶年。\n善者果而已，不敢以取强。\n果而勿矜，果而勿伐，果而勿骄，果而不得已，果而勿强。\n物壮则老，是谓不道，不道早已。" },
            { id: 31, text: "夫佳兵者，不祥之器，物或恶之，故有道者不处。\n君子居则贵左，用兵则贵右。\n兵者不祥之器，非君子之器，不得已而用之，恬淡为上。\n胜而不美，而美之者，是乐杀人。\n夫乐杀人者，则不可以得志于天下矣。\n吉事尚左，凶事尚右。\n偏将军居左，上将军居右，言以丧礼处之。\n杀人之众，以哀悲泣之，战胜以丧礼处之。" },
            { id: 32, text: "道常无名，朴虽小，天下莫能臣。\n侯王若能守之，万物将自宾。\n天地相合，以降甘露，民莫之令而自均。\n始制有名，名亦既有，夫亦将知止，知止可以不殆。\n譬道之在天下，犹川谷之于江海。" },
            { id: 33, text: "知人者智，自知者明。\n胜人者有力，自胜者强。\n知足者富，强行者有志。\n不失其所者久，死而不亡者寿。" },
            { id: 34, text: "大道泛兮，其可左右。\n万物恃之而生而不辞，功成不名有，衣养万物而不为主。\n常无欲，可名于小；万物归焉而不为主，可名为大。\n以其终不自为大，故能成其大。" },
            { id: 35, text: "执大象，天下往。往而不害，安平太。\n乐与饵，过客止。\n道之出口，淡乎其无味，视之不足见，听之不足闻，用之不足既。" },
            { id: 36, text: "将欲歙之，必固张之；将欲弱之，必固强之；将欲废之，必固兴之；将欲夺之，必固与之。\n是谓微明。\n柔弱胜刚强。\n鱼不可脱于渊，国之利器不可以示人。" },
            { id: 37, text: "道常无为而无不为。\n侯王若能守之，万物将自化。\n化而欲作，吾将镇之以无名之朴。\n无名之朴，夫亦将无欲。\n不欲以静，天下将自定。" },
            // 第三十八章 至 第八十一章 (德经部分)
            { id: 38, text: "上德不德，是以有德；下德不失德，是以无德。\n上德无为而无以为；下德为之而有以为。\n上仁为之而无以为；上义为之而有以为。\n上礼为之而莫之应，则攘臂而扔之。\n故失道而后德，失德而后仁，失仁而后义，失义而后礼。\n夫礼者，忠信之薄，而乱之首。\n前识者，道之华，而愚之始。\n是以大丈夫处其厚，不居其薄；处其实，不居其华。\n故去彼取此。" },
            { id: 39, text: "昔之得一者：\n天得一以清；地得一以宁；神得一以灵；谷得一以盈；\n万物得一以生；侯王得一以为天下正。\n其致之也，谓天无以清，将恐裂；地无以宁，将恐废；\n神无以灵，将恐歇；谷无以盈，将恐竭；万物无以生，将恐灭；\n侯王无以正，将恐蹶。\n故贵以贱为本，高以下为基。\n是以侯王自称孤、寡、不谷。\n此非以贱为本邪？非乎？\n故致誉无誉。是故不欲琭琭如玉，珞珞如石。" },
            { id: 40, text: "反者道之动；弱者道之用。\n天下万物生于有，有生于无。" },
            { id: 41, text: "上士闻道，勤而行之；中士闻道，若存若亡；下士闻道，大笑之。\n不笑不足以为道。\n故建言有之：\n明道若昧，进道若退，夷道若颣。\n上德若谷，广德若不足，建德若偷，质真若渝。\n大白若辱，大方无隅，大器晚成，大音希声，大象无形。\n道隐无名。\n夫唯道，善贷且成。" },
            { id: 42, text: "道生一，一生二，二生三，三生万物。\n万物负阴而抱阳，冲气以为和。\n人之所恶，唯孤、寡、不谷，而王公以为称。\n故物或损之而益，或益之而损。\n人之所教，亦我而教父。\n强梁者不得其死，吾将以为教父。" },
            { id: 43, text: "天下之至柔，驰骋天下之至坚。\n无有入无间。\n吾是以知无为之有益。\n不言之教，无为之益，天下希及之。" },
            { id: 44, text: "名与身孰亲？身与货孰多？得与亡孰病？\n是故甚爱必大费，多藏必厚亡。\n知足不辱，知止不殆，可以长久。" },
            { id: 45, text: "大成若缺，其用不弊。\n大盈若冲，其用不穷。\n大直若屈，大巧若拙，大辩若讷。\n静胜躁，寒胜热。\n清静为天下正。" },
            { id: 46, text: "天下有道，却走马以粪。\n天下无道，戎马生于郊。\n祸莫大于不知足；咎莫大于欲得。\n故知足之足，常足矣。" },
            { id: 47, text: "不出户，知天下；不窥牖，见天道。\n其出弥远，其知弥少。\n是以圣人不行而知，不见而明，不为而成。" },
            { id: 48, text: "为学日益，为道日损。\n损之又损，以至于无为。\n无为而无不为。\n取天下常以无事，及其有事，不足以取天下。" },
            { id: 49, text: "圣人无常心，以百姓心为心。\n善者，吾善之；不善者，吾亦善之，德善。\n信者，吾信之；不信者，吾亦信之，德信。\n圣人在天下，歙歙焉，为天下浑其心。\n百姓皆注其耳目，圣人皆孩之。" },
            { id: 50, text: "出生入死。\n生之徒，十有三；死之徒，十有三；人之生，动之于死地，亦十有三。\n夫何故？以其生生之厚。\n盖闻善摄生者，陆行不遇兕虎，入军不被甲兵。\n兕无所投其角，虎无所用其爪，兵无所容其刃。\n夫何故？以其无死地。" },
            { id: 51, text: "道生之，德畜之，物形之，势成之。\n是以万物莫不尊道而贵德。\n道之尊，德之贵，夫莫之命常自然。\n故道生之，德畜之；长之育之；成之熟之；养之覆之。\n生而不有，为而不恃，长而不宰，是谓玄德。" },
            { id: 52, text: "天下有始，以为天下母。\n既得其母，以知其子；既知其子，复守其母，没身不殆。\n塞其兑，闭其门，终身不勤。\n开其兑，济其事，终身不救。\n见小曰明，守柔曰强。\n用其光，复归其明，无遗身殃，是为习常。" },
            { id: 53, text: "使我介然有知，行于大道，唯施是畏。\n大道甚夷，而民好径。\n朝甚除，田甚芜，仓甚虚；\n服文彩，带利剑，厌饮食，财货有余；\n是为盗夸。\n非道也哉！" },
            { id: 54, text: "善建者不拔，善抱者不脱，子孙以祭祀不辍。\n修之于身，其德乃真；修之于家，其德乃余；\n修之于乡，其德乃长；修之于邦，其德乃丰；\n修之于天下，其德乃普。\n故以身观身，以家观家，以乡观乡，以邦观邦，以天下观天下。\n吾何以知天下然哉？以此。" },
            { id: 55, text: "含德之厚，比于赤子。\n蜂虿虺蛇不螫，攫鸟猛兽不搏。\n骨弱筋柔而握固。\n未知牝牡之合而朘作，精之至也。\n终日号而不嗄，和之至也。\n知和曰常，知常曰明。\n益生曰祥，心使气曰强。\n物壮则老，谓之不道，不道早已。" },
            { id: 56, text: "知者不言，言者不知。\n塞其兑，闭其门；挫其锐，解其分；和其光，同其尘，是谓玄同。\n故不可得而亲，不可得而疏；\n不可得而利，不可得而害；\n不可得而贵，不可得而贱。\n故为天下贵。" },
            { id: 57, text: "以正治国，以奇用兵，以无事取天下。\n吾何以知其然哉？以此：\n天下多忌讳，而民弥贫；民多利器，国家滋昏；\n人多伎巧，奇物滋起；法令滋彰，盗贼多有。\n故圣人云：我无为而民自化，我好静而民自正，我无事而民自富，我无欲而民自朴。" },
            { id: 58, text: "其政闷闷，其民淳淳；其政察察，其民缺缺。\n祸兮福之所倚，福兮祸之所伏。\n孰知其极？其无正也。\n正复为奇，善复为妖。\n人之迷，其日固久。\n是以圣人方而不割，廉而不刿，直而不肆，光而不耀。" },
            { id: 59, text: "治人事天，莫若啬。\n夫唯啬，是谓早服；早服谓之重积德；重积德则无不克；\n无不克则莫知其极；莫知其极，可以有国；有国之母，可以长久。\n是谓深根固柢，长生久视之道。" },
            { id: 60, text: "治大国，若烹小鲜。\n以道莅天下，其鬼不神；非其鬼不神，其神不伤人；\n非其神不伤人，圣人亦不伤人。\n夫两不相伤，故德交归焉。" },
            { id: 61, text: "大国者下流，天下之交，天下之牝。\n牝常以静胜牡，以静为下。\n故大国以下小国，则取小国；小国以下大国，则取大国。\n故或下以取，或下而取。\n大国不过欲兼畜人，小国不过欲入事人。\n夫两者各得其所欲，大者宜为下。" },
            { id: 62, text: "道者万物之奥。\n善人之宝，不善人之所保。\n美言可以市尊，美行可以加人。\n人之不善，何弃之有？\n故立天子，置三公，虽有拱璧以先驷马，不如坐进此道。\n古之所以贵此道者何？不曰：求以得，有罪以免邪？故为天下贵。" },
            { id: 63, text: "为无为，事无事，味无味。\n大小多少，抱怨以德。\n图难于其易，为大于其细。\n天下难事，必作于易；天下大事，必作于细。\n是以圣人终不为大，故能成其大。\n夫轻诺必寡信，多易必多难。\n是以圣人犹难之，故终无难矣。" },
            { id: 64, text: "其安易持，其未兆易谋；\n其脆易泮，其微易散。\n为之于未有，治之于未乱。\n合抱之木，生于毫末；九层之台，起于累土；千里之行，始于足下。\n为者败之，执者失之。\n是以圣人无为故无败，无执故无失。\n民之从事，常于几成而败之。\n慎终如始，则无败事。\n是以圣人欲不欲，不贵难得之货；\n学不学，复众人之所过。\n以辅万物之自然而不敢为。" },
            { id: 65, text: "古之善为道者，非以明民，将以愚之。\n民之难治，以其智多。\n故以智治国，国之贼；不以智治国，国之福。\n知此两者，亦稽式。\n常知稽式，是谓玄德。\n玄德深矣，远矣，与物反矣，然后乃至大顺。" },
            { id: 66, text: "江海所以能为百谷王者，以其善下之，故能为百谷王。\n是以欲上民，必以言下之；欲先民，必以身后之。\n是以圣人处上而民不重，处前而民不害。\n是以天下乐推而不厌。\n以其不争，故天下莫能与之争。" },
            { id: 67, text: "天下皆谓我道大，似不肖。\n夫唯大，故似不肖。\n若肖，久矣其细也夫！\n我有三宝，持而保之。\n一曰慈，二曰俭，三曰不敢为天下先。\n慈故能勇；俭故能广；不敢为天下先，故能成器长。\n今舍慈且勇，舍俭且广，舍后且先，死矣！\n夫慈，以战则胜，以守则固。\n天将救之，以慈卫之。" },
            { id: 68, text: "善为士者不武，善战者不怒，善胜敌者不与，善用人者为之下。\n是谓不争之德，是谓用人之力，是谓配天古之极。" },
            { id: 69, text: "用兵有言：吾不敢为主而为客，不敢进寸而退尺。\n是谓行无行，攘无臂，扔无敌，执无兵。\n祸莫大于轻敌，轻敌几丧吾宝。\n故抗兵相加，哀者胜矣。" },
            { id: 70, text: "吾言甚易知，甚易行。\n天下莫能知，莫能行。\n言有宗，事有君。\n夫唯无知，是以不我知。\n知我者希，则我者贵。\n是以圣人被褐怀玉。" },
            { id: 71, text: "知不知，上；不知知，病。\n夫唯病病，是以不病。\n圣人不病，以其病病，是以不病。" },
            { id: 72, text: "民不畏威，则大威至。\n无狎其所居，无厌其所生。\n夫唯不厌，是以不厌。\n是以圣人自知不自见，自爱不自贵。\n故去彼取此。" },
            { id: 73, text: "勇于敢则杀，勇于不敢则活。\n此两者，或利或害。\n天之所恶，孰知其故？\n是以圣人犹难之。\n天之道，不争而善胜，不言而善应，不召而自来，繟然而善谋。\n天网恢恢，疏而不失。" },
            { id: 74, text: "民不畏死，奈何以死惧之？\n若使民常畏死，而为奇者，吾得执而杀之，孰敢？\n常有司杀者杀。\n夫代司杀者杀，是谓代大匠斲。\n夫代大匠斲者，希有不伤其手矣。" },
            { id: 75, text: "民之饥，以其上食税之多，是以饥。\n民之难治，以其上之有为，是以难治。\n民之轻死，以其求生之厚，是以轻死。\n夫唯无以生为者，是贤于贵生。" },
            { id: 76, text: "人之生也柔弱，其死也坚强。\n万物草木之生也柔脆，其死也枯槁。\n故坚强者死之徒，柔弱者生之徒。\n是以兵强则不胜，木强则兵。\n强大处下，柔弱处上。" },
            { id: 77, text: "天之道，其犹张弓与？\n高者抑之，下者举之；有余者损之，不足者补之。\n天之道，损有余而补不足。\n人之道则不然，损不足以奉有余。\n孰能有余以奉天下？唯有道者。\n是以圣人为而不恃，功成而不处，其不欲见贤。" },
            { id: 78, text: "天下莫柔弱于水，而攻坚强者莫之能胜，其无以易之。\n弱之胜强，柔之胜刚，天下莫不知，莫能行。\n是以圣人云：受国之垢，是谓社稷主；受国不祥，是谓天下王。\n正言若反。" },
            { id: 79, text: "和大怨，必有余怨，安可以为善？\n是以圣人执左契，而不责于人。\n有德司契，无德司彻。\n天道无亲，常与善人。" },
            { id: 80, text: "小国寡民。\n使有什伯之器而不用，使民重死而不远徙。\n虽有舟舆，无所乘之；虽有甲兵，无所陈之。\n使人复结绳而用之。\n甘其食，美其服，安其居，乐其俗。\n邻国相望，鸡犬之声相闻，民至老死不相往来。" },
            { id: 81, text: "信言不美，美言不信。\n善者不辩，辩者不善。\n知者不博，博者不知。\n圣人不积，既以为人己愈有，既以与人己愈多。\n天之道，利而不害；圣人之道，为而不争。" }
        ];

        // 使用完整的道德经数据
        const fullChapters = daoDeJing;

        let currentChapterIndex = -1;

        // DOM 元素
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const chapterList = document.getElementById('chapter-list');
        const introView = document.getElementById('intro-view');
        const chapterView = document.getElementById('chapter-view');
        const chapterTitle = document.getElementById('chapter-title');
        const chapterText = document.getElementById('chapter-text');
        const currentNumDisplay = document.getElementById('current-chapter-num');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const menuBtn = document.getElementById('menu-btn');
        const contentArea = document.getElementById('content-area');

        // 初始化目录
        function initSidebar() {
            fullChapters.forEach((chapter, index) => {
                const item = document.createElement('div');
                item.className = 'chapter-nav-item px-6 py-3 cursor-pointer text-stone-600 hover:text-stone-900 transition-colors duration-200 text-sm font-serif border-l-2 border-transparent hover:border-stone-300';
                item.innerHTML = `<span class="text-xs text-stone-400 mr-2 opacity-70 font-sans">CH.${chapter.id}</span> ${getChapterTitle(chapter.id)}`;
                item.onclick = () => {
                    loadChapter(index);
                    closeSidebar();
                };
                chapterList.appendChild(item);
            });
        }

        // 改进的标题生成逻辑 (使用道德经章节的传统名称)
        function getChapterTitle(id) {
            const titles = {
                1: "论道", 2: "修身", 3: "无为", 4: "象微", 5: "守中", 6: "冲和", 7: "无私", 8: "上善", 9: "持盈", 10: "复朴",
                11: "无用", 12: "去私", 13: "谦德", 14: "观妙", 15: "复命", 16: "归根", 17: "淳风", 18: "还淳", 19: "淳德", 20: "向道",
                21: "虚心", 22: "益谦", 23: "道德", 24: "法自然", 25: "道性", 26: "重德", 27: "巧用", 28: "反朴", 29: "威信", 30: "俭武",
                31: "偃武", 32: "辩德", 33: "任为", 34: "仁德", 35: "微明", 36: "为政", 37: "玄德", 38: "玄道", 39: "淳德", 40: "从道",
                41: "闻道", 42: "同德", 43: "立戒", 44: "洪德", 45: "极象", 46: "还淳", 47: "知用", 48: "返朴", 49: "淳风", 50: "守道",
                51: "德信", 52: "复朴", 53: "守微", 54: "修德", 55: "玄符", 56: "玄德", 57: "淳风", 58: "顺化", 59: "守道", 60: "居位",
                61: "谦德", 62: "为道", 63: "恩始", 64: "守微", 65: "淳德", 66: "顺动", 67: "江海", 68: "任为", 69: "用德", 70: "知难",
                71: "用道", 72: "正喻", 73: "任德", 74: "制惑", 75: "贪德", 76: "戒用", 77: "天道", 78: "任契", 79: "独立", 80: "去奢", 81: "信道"
            };
            return titles[id] || `第${numberToChinese(id)}章`;
        }

        function numberToChinese(num) {
            const chnNumChar = ["零","一","二","三","四","五","六","七","八","九"];
            const chnUnitSection = ["","万","亿","万亿","亿亿"];
            const chnUnitChar = ["","十","百","千"];
            // 简易转换，适用于1-99
            if(num <= 10) return num === 10 ? '十' : chnNumChar[num];
            if(num < 20) return '十' + chnNumChar[num%10];
            let str = num.toString();
            let res = '';
            if(str.length === 2) {
                res = chnNumChar[parseInt(str[0])] + '十';
                if(str[1] !== '0') res += chnNumChar[parseInt(str[1])];
            }
            return res;
        }

        // 加载章节
        function loadChapter(index) {
            if (index < 0 || index >= fullChapters.length) return;
            
            currentChapterIndex = index;
            const chapter = fullChapters[index];
            
            // 切换视图
            introView.classList.add('hidden');
            chapterView.classList.remove('hidden');
            
            // 重新触发动画
            chapterView.classList.remove('fade-in');
            void chapterView.offsetWidth; // trigger reflow
            chapterView.classList.add('fade-in');

            // 更新内容
            chapterTitle.textContent = `第${numberToChinese(chapter.id)}章`;
            
            // 处理文本换行
            const formattedText = chapter.text.split('\n').map(line => `<p class="mb-6">${line}</p>`).join('');
            chapterText.innerHTML = formattedText;
            
            currentNumDisplay.textContent = chapter.id;

            // 更新按钮状态
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === fullChapters.length - 1;
            prevBtn.onclick = () => loadChapter(index - 1);
            nextBtn.onclick = () => loadChapter(index + 1);

            // 更新目录高亮
            updateSidebarActiveState(index);
            
            // 滚动到顶部
            document.querySelector('main').scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateSidebarActiveState(index) {
            const items = chapterList.children;
            for (let i = 0; i < items.length; i++) {
                if (i === index) {
                    items[i].classList.add('active');
                    // 确保可见，但使用非平滑滚动以避免影响主内容
                    items[i].scrollIntoView({ behavior: 'auto', block: 'nearest' });
                } else {
                    items[i].classList.remove('active');
                }
            }
        }

        // 侧边栏交互
        function openSidebar() {
            sidebar.classList.remove('-translate-x-full');
            overlay.classList.remove('hidden');
            setTimeout(() => overlay.classList.remove('opacity-0'), 10);
        }

        function closeSidebar() {
            sidebar.classList.add('-translate-x-full');
            overlay.classList.add('opacity-0');
            setTimeout(() => overlay.classList.add('hidden'), 300);
        }

        menuBtn.onclick = openSidebar;
        overlay.onclick = closeSidebar;

        // 搜索功能
        function searchChapter(keyword) {
            const results = fullChapters.filter(chapter =>
                chapter.text.toLowerCase().includes(keyword.toLowerCase())
            );

            if (results.length > 0) {
                // 显示搜索结果
                loadChapter(fullChapters.indexOf(results[0]));
                // 也可以在这里显示搜索结果列表
                console.log(`找到 ${results.length} 个结果，第一个在第 ${results[0].id} 章`);
            } else {
                alert('未找到相关内容');
            }
        }

        // 键盘快捷键
        document.addEventListener('keydown', (e) => {
            if (currentChapterIndex === -1) return;

            // 左右箭头键翻页
            if (e.key === 'ArrowLeft') loadChapter(currentChapterIndex - 1);
            if (e.key === 'ArrowRight') loadChapter(currentChapterIndex + 1);

            // 'S' 键显示搜索框
            if (e.key === 's' || e.key === 'S') {
                const keyword = prompt('请输入搜索关键词：');
                if (keyword) searchChapter(keyword);
            }

            // 'H' 键返回首页
            if (e.key === 'h' || e.key === 'H') {
                introView.classList.remove('hidden');
                chapterView.classList.add('hidden');
                currentChapterIndex = -1;
            }
        });

        // 初始化
        initSidebar();

        // 添加搜索框到侧边栏
        function addSearchToSidebar() {
            const searchDiv = document.createElement('div');
            searchDiv.className = 'p-4 border-b border-stone-300';
            searchDiv.innerHTML = `
                <input type="text" id="search-input" placeholder="搜索道德经..."
                    class="w-full px-3 py-2 border border-stone-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-stone-400">
            `;
            chapterList.parentNode.insertBefore(searchDiv, chapterList);

            document.getElementById('search-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchChapter(e.target.value);
                }
            });
        }

        addSearchToSidebar();

    </script>
</body>
</html>